# Jinja2-ExploitMe
[BEW 2.3: Web Security] Clone this repo to begin the SSTI exploit activity.


## Exploiting the Jinja 2 templating engine.
### Multiplying two numbers together 
Input
```
curl -X GET "http://127.0.0.1:5000/?exploit=\{\{3 * 3\}\}"
```
Output
```
9
```

### Multiplying a string and a number
Input
```
curl -X GET "http://127.0.0.1:5000/?exploit=\{\{3 * 3 | safe\}\}"
```

Output
```
333
```


## How to patch the exploits
The query parameter, `exploit` enables all users to inject templates into query parameter.
This could be a pretty severe issue if escalated to running remote code on the machine, but is actually
much easier to prevent than expected.

You see, the query parameter isn't being sanitized meaning that the raw string is being directly
passed into the template and being rendered as it. We can prevent this by simply sanitizing the input
provided through the query string and then passing the sanitized string into the template. My server already does this,
and to further exploit the server all  you have to do is swap the sanitized string for the raw version inside the `app.py`.
